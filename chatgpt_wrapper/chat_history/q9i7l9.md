Model: GPT-4

> Generate a prompt that will enable GPT-4 to act as an expert in SQL refactoring, providing guidance on how to refactor code effectively. When continuing with code examples, always use markdown code blocks. In the case of refactoring primary key columns, the preferred column name should be 'id'.
> 
> 1 / 1

**Prompt:**

As an expert in SQL refactoring, please provide guidance on how to refactor SQL code effectively, including best practices and optimization techniques. Include examples of refactoring primary key columns, using 'id' as the preferred column name, and demonstrate how to improve code readability and maintainability. Provide examples using markdown code blocks for better understanding.

1 / 1

> As an expert in SQL refactoring, please provide guidance on how to refactor SQL code effectively, including best practices and optimization techniques. Include examples of refactoring primary key columns, using 'id' as the preferred column name, and demonstrate how to improve code readability and maintainability. Provide examples using markdown code blocks for better understanding.
> 
> 1 / 1

Refactoring SQL code effectively

1 / 1

> want to refactor the schema in relation to users. How could these table defs be improved? Ensure that they keep their user\_ prefix where applicable CREATE TABLE user\_access\_logs ( access\_log\_id INT PRIMARY KEY, user\_id INT, action VARCHAR(255) NOT NULL, ip\_address VARCHAR(45), user\_agent TEXT, accessed\_at TIMESTAMP NOT NULL,, FOREIGN KEY (user\_id) REFERENCES users(user\_id) ); CREATE TABLE user\_activity\_logs ( event\_log\_id INT PRIMARY KEY, user\_id INT, event\_type VARCHAR(255) NOT NULL, event\_description TEXT, event\_timestamp TIMESTAMP NOT NULL,, FOREIGN KEY (user\_id) REFERENCES users(user\_id) ); CREATE TABLE user\_alerts ( notification\_id INT PRIMARY KEY, user\_id INT, notification\_text TEXT NOT NULL, read\_status BOOLEAN NOT NULL DEFAULT FALSE, CREATEd\_at TIMESTAMP NOT NULL,, FOREIGN KEY (user\_id) REFERENCES users(user\_id) ); CREATE TABLE user\_api\_credentials ( api\_key\_id INT PRIMARY KEY, user\_id INT, api\_key VARCHAR(255) NOT NULL UNIQUE, CREATEd\_at TIMESTAMP NOT NULL, expires\_at TIMESTAMP NOT NULL,, FOREIGN KEY (user\_id) REFERENCES users(user\_id) ); CREATE TABLE user\_appointments ( reminder\_id INT PRIMARY KEY, user\_id INT, target\_user\_id INT, title VARCHAR(255), description TEXT, reminder\_text TEXT, reminder\_date DATE, remind\_at TIMESTAMP, is\_completed BOOLEAN NOT NULL DEFAULT FALSE, completed BOOLEAN NOT NULL DEFAULT FALSE, FOREIGN KEY (user\_id) REFERENCES users(user\_id), FOREIGN KEY (target\_user\_id) REFERENCES users(user\_id) ); CREATE TABLE user\_custom\_field\_entries ( custom\_field\_value\_id INT PRIMARY KEY, user\_id INT, custom\_field\_id INT, value TEXT NOT NULL,, FOREIGN KEY (user\_id) REFERENCES users(user\_id),, FOREIGN KEY (custom\_field\_id) REFERENCES custom\_field\_definitions(custom\_field\_id) ); CREATE TABLE user\_documents ( document\_id INT PRIMARY KEY, user\_id INT, document\_type\_id INT, document\_url VARCHAR(255) NOT NULL, uploaded\_at TIMESTAMP NOT NULL,, FOREIGN KEY (user\_id) REFERENCES users(user\_id),, FOREIGN KEY (document\_type\_id) REFERENCES document\_types(document\_type\_id) ); CREATE TABLE user\_educational\_background (user\_education\_id INT PRIMARY KEY, user\_id INT, education\_level\_id INT, institution\_name VARCHAR(255) NOT NULL, major VARCHAR(255), start\_date DATE NOT NULL, end\_date DATE,, FOREIGN KEY (user\_id) REFERENCES users(user\_id),, FOREIGN KEY (education\_level\_id) REFERENCES education\_levels(education\_level\_id)); CREATE TABLE user\_favorite\_candidates ( saved\_candidate\_id INT PRIMARY KEY, user\_id INT, candidate\_id INT, saved\_at TIMESTAMP NOT NULL,, FOREIGN KEY (user\_id) REFERENCES users(user\_id),, FOREIGN KEY (candidate\_id) REFERENCES users(user\_id) ); CREATE TABLE user\_favorite\_job\_posts ( saved\_job\_id INT PRIMARY KEY, user\_id INT, job\_id INT, saved\_at TIMESTAMP NOT NULL,, FOREIGN KEY (user\_id) REFERENCES users(user\_id),, FOREIGN KEY (job\_id) REFERENCES job\_posts(job\_id) ); CREATE TABLE user\_favorite\_searches ( saved\_search\_id INT PRIMARY KEY, user\_id INT, search\_name VARCHAR(255) NOT NULL, search\_query TEXT NOT NULL, CREATEd\_at TIMESTAMP NOT NULL,, FOREIGN KEY (user\_id) REFERENCES users(user\_id) ); CREATE TABLE user\_files ( attachment\_id INT PRIMARY KEY, user\_id INT, file\_name VARCHAR(255) NOT NULL, file\_path TEXT NOT NULL, file\_type VARCHAR(255) NOT NULL, file\_size INT NOT NULL, uploaded\_at TIMESTAMP NOT NULL,, FOREIGN KEY (user\_id) REFERENCES users(user\_id) ); CREATE TABLE user\_login\_sessions ( session\_id INT PRIMARY KEY, user\_id INT, session\_token VARCHAR(255) NOT NULL UNIQUE, ip\_address VARCHAR(45), user\_agent TEXT, CREATEd\_at TIMESTAMP NOT NULL, expires\_at TIMESTAMP NOT NULL,, FOREIGN KEY (user\_id) REFERENCES users(user\_id) ); CREATE TABLE user\_memo ( note\_id INT PRIMARY KEY, user\_id INT, author\_id INT, note\_text TEXT NOT NULL, CREATEd\_at TIMESTAMP NOT NULL,, FOREIGN KEY (user\_id) REFERENCES users(user\_id),, FOREIGN KEY (author\_id) REFERENCES users(user\_id) ); CREATE TABLE user\_messages ( communication\_id INT PRIMARY KEY, user\_id INT, author\_id INT, communication\_type VARCHAR(255) NOT NULL, content TEXT NOT NULL, CREATEd\_at TIMESTAMP NOT NULL,, FOREIGN KEY (user\_id) REFERENCES users(user\_id),, FOREIGN KEY (author\_id) REFERENCES users(user\_id) ); CREATE TABLE user\_onboarding\_checklist\_entries ( user\_checklist\_item\_id INT PRIMARY KEY, user\_checklist\_id INT, checklist\_item\_id INT, completed BOOLEAN NOT NULL DEFAULT FALSE,, FOREIGN KEY (user\_checklist\_id) REFERENCES user\_onboarding\_templates(user\_checklist\_id),, FOREIGN KEY (checklist\_item\_id) REFERENCES onboarding\_checklist\_entries(checklist\_item\_id) ); CREATE TABLE user\_onboarding\_templates ( user\_checklist\_id INT PRIMARY KEY, user\_id INT, checklist\_id INT,, FOREIGN KEY (user\_id) REFERENCES users(user\_id),, FOREIGN KEY (checklist\_id) REFERENCES onboarding\_templates(checklist\_id) ); CREATE TABLE user\_permissions ( permission\_id INT PRIMARY KEY, permission\_name VARCHAR(255) NOT NULL UNIQUE, permission\_description TEXT ); CREATE TABLE user\_skills (user\_skill\_id INT PRIMARY KEY, user\_id INT, skill\_id INT, experience\_years DECIMAL(3,1),, FOREIGN KEY (user\_id) REFERENCES users(user\_id),, FOREIGN KEY (skill\_id) REFERENCES skill\_definitions(skill\_id)); CREATE TABLE user\_tag\_definitions ( assignment\_id INT PRIMARY KEY, user\_id INT, tag\_id INT,, FOREIGN KEY (user\_id) REFERENCES users(user\_id),, FOREIGN KEY (tag\_id) REFERENCES user\_tag\_definitions(tag\_id) ); CREATE TABLE user\_tag\_definitions ( tag\_id INT PRIMARY KEY, tag\_name VARCHAR(255) NOT NULL UNIQUE ); CREATE TABLE user\_tag\_relations ( association\_id INT PRIMARY KEY, user\_id INT, tag\_id INT,, FOREIGN KEY (user\_id) REFERENCES users(user\_id),, FOREIGN KEY (tag\_id) REFERENCES user\_tag\_definitions(tag\_id) ); CREATE TABLE users ( user\_id INT PRIMARY KEY, first\_name VARCHAR(255) NOT NULL, last\_name VARCHAR(255) NOT NULL, email VARCHAR(255) NOT NULL UNIQUE, phone\_number VARCHAR(20), password VARCHAR(255) NOT NULL, role VARCHAR(255) NOT NULL, CREATEd\_at TIMESTAMP NOT NULL, updated\_at TIMESTAMP );
> 
> 2 / 2

Here are some improvements to consider when refactoring the table definitions:

1.  Use consistent naming conventions for primary key columns and foreign keys.
2.  Replace any `VARCHAR(255)` type for columns that could be `TEXT` type.
3.  Remove any trailing commas after the `NOT NULL` constraint.
4.  Ensure consistency in the use of uppercase and lowercase for keywords and datatypes.

Here are the refactored table definitions:

sql

```sql
CREATE TABLE user_access_logs (
    id INT PRIMARY KEY,
    user_id INT,
    action TEXT NOT NULL,
    ip_address VARCHAR(45),
    user_agent TEXT,
    accessed_at TIMESTAMP NOT NULL,
    FOREIGN KEY (user_id) REFERENCES users(id)
);

CREATE TABLE user_activity_logs (
    id INT PRIMARY KEY,
    user_id INT,
    event_type TEXT NOT NULL,
    event_description TEXT,
    event_timestamp TIMESTAMP NOT NULL,
    FOREIGN KEY (user_id) REFERENCES users(id)
);

CREATE TABLE user_alerts (
    id INT PRIMARY KEY,
    user_id INT,
    notification_text TEXT NOT NULL,
    read_status BOOLEAN NOT NULL DEFAULT FALSE,
    created_at TIMESTAMP NOT NULL,
    FOREIGN KEY (user_id) REFERENCES users(id)
);

CREATE TABLE user_api_credentials (
    id INT PRIMARY KEY,
    user_id INT,
    api_key VARCHAR(255) NOT NULL UNIQUE,
    created_at TIMESTAMP NOT
```

1 / 1

> continue
> 
> 1 / 1

sql

    ```sql
NOT NULL,
    expires_at TIMESTAMP NOT NULL,
    FOREIGN KEY (user_id) REFERENCES users(id)
);

CREATE TABLE user_appointments (
    id INT PRIMARY KEY,
    user_id INT,
    target_user_id INT,
    title TEXT,
    description TEXT,
    reminder_text TEXT,
    reminder_date DATE,
    remind_at TIMESTAMP,
    is_completed BOOLEAN NOT NULL DEFAULT FALSE,
    completed BOOLEAN NOT NULL DEFAULT FALSE,
    FOREIGN KEY (user_id) REFERENCES users(id),
    FOREIGN KEY (target_user_id) REFERENCES users(id)
);

CREATE TABLE user_custom_field_entries (
    id INT PRIMARY KEY,
    user_id INT,
    custom_field_id INT,
    value TEXT NOT NULL,
    FOREIGN KEY (user_id) REFERENCES users(id),
    FOREIGN KEY (custom_field_id) REFERENCES custom_field_definitions(id)
);

CREATE TABLE user_documents (
    id INT PRIMARY KEY,
    user_id INT,
    document_type_id INT,
    document_url TEXT NOT NULL,
    uploaded_at TIMESTAMP NOT NULL,
    FOREIGN KEY (user_id) REFERENCES users(id),
    FOREIGN KEY (document_type_id) REFERENCES document_types(id)
);

CREATE TABLE user_educational_background (
    id INT PRIMARY KEY,
    user_id INT,
    education_level_id INT,
    institution_name TEXT NOT NULL,
    major TEXT,
```

1 / 1

> These tables are for an Applicant Tracking System. I want to refactor the schema in relation to jobs and postings. How could these table definitions be improved? Ensure that they keep their job\_; job\_post\_ prefix where applicable. Primary keys should be named 'id'. Can you include comments for each of the columns in addition to a table level comment that is stored within the table ddl. CREATE TABLE job\_application\_statuses ( status\_id INT PRIMARY KEY, status\_name VARCHAR(255) NOT NULL UNIQUE ); CREATE TABLE job\_applications ( application\_id INT PRIMARY KEY, job\_id INT, user\_id INT, application\_status\_id INT, resume\_url VARCHAR(255) NOT NULL, cover\_letter\_url VARCHAR(255), application\_status VARCHAR(255) NOT NULL, applied\_at TIMESTAMP NOT NULL, FOREIGN KEY (job\_id) REFERENCES job\_posts(job\_id), FOREIGN KEY (user\_id) REFERENCES users(user\_id), FOREIGN KEY (application\_status\_id) REFERENCES application\_statuses(status\_id) ); CREATE TABLE job\_offer\_statuses ( offer\_status\_id INT PRIMARY KEY, status\_name VARCHAR(255) NOT NULL UNIQUE ); CREATE TABLE job\_offers ( offer\_id INT PRIMARY KEY, application\_id INT, offer\_status\_id INT, salary DECIMAL(10,2) NOT NULL, start\_date DATE NOT NULL, offer\_date DATE NOT NULL, accepted\_date DATE, declined\_date DATE,, FOREIGN KEY (application\_id) REFERENCES job\_applications(application\_id),, FOREIGN KEY (offer\_status\_id) REFERENCES job\_offer\_statuses(offer\_status\_id) ); CREATE TABLE job\_positions ( position\_id INT PRIMARY KEY, position\_title VARCHAR(255) NOT NULL UNIQUE ); CREATE TABLE job\_post\_access\_logs ( access\_log\_id INT PRIMARY KEY, job\_id INT, user\_id INT, action VARCHAR(255) NOT NULL, ip\_address VARCHAR(45), user\_agent TEXT, accessed\_at TIMESTAMP NOT NULL,, FOREIGN KEY (job\_id) REFERENCES job\_posts(job\_id),, FOREIGN KEY (user\_id) REFERENCES users(user\_id) ); CREATE TABLE job\_post\_activity\_logs ( activity\_log\_id INT PRIMARY KEY, job\_id INT, user\_id INT, activity VARCHAR(255) NOT NULL, description TEXT, activity\_timestamp TIMESTAMP NOT NULL, FOREIGN KEY (job\_id) REFERENCES job\_posts(job\_id), FOREIGN KEY (user\_id) REFERENCES users(user\_id)); CREATE TABLE job\_post\_attachments ( attachment\_id INT PRIMARY KEY, job\_id INT, file\_name VARCHAR(255) NOT NULL, file\_path TEXT NOT NULL, file\_type VARCHAR(255) NOT NULL, file\_size INT NOT NULL, uploaded\_at TIMESTAMP NOT NULL,, FOREIGN KEY (job\_id) REFERENCES job\_posts(job\_id) ); CREATE TABLE job\_post\_communications ( communication\_id INT PRIMARY KEY, job\_id INT, author\_id INT, communication\_type VARCHAR(255) NOT NULL, content TEXT NOT NULL, CREATEd\_at TIMESTAMP NOT NULL,, FOREIGN KEY (job\_id) REFERENCES job\_posts(job\_id),, FOREIGN KEY (author\_id) REFERENCES users(user\_id) ); CREATE TABLE job\_post\_custom\_field\_definitions ( job\_post\_custom\_field\_id INT PRIMARY KEY, job\_id INT, custom\_field\_id INT, value TEXT NOT NULL,, FOREIGN KEY (job\_id) REFERENCES job\_posts(job\_id),, FOREIGN KEY (custom\_field\_id) REFERENCES custom\_field\_definitions(custom\_field\_id) ); CREATE TABLE job\_post\_custom\_field\_values ( value\_id INT PRIMARY KEY, job\_id INT, custom\_field\_id INT, value TEXT,, FOREIGN KEY (job\_id) REFERENCES job\_posts(job\_id),, FOREIGN KEY (custom\_field\_id) REFERENCES custom\_field\_definitions(custom\_field\_id) ); CREATE TABLE job\_post\_event\_logs ( event\_log\_id INT PRIMARY KEY, job\_id INT, user\_id INT, event\_type VARCHAR(255) NOT NULL, event\_description TEXT, event\_timestamp TIMESTAMP NOT NULL,, FOREIGN KEY (job\_id) REFERENCES job\_posts(job\_id),, FOREIGN KEY (user\_id) REFERENCES users(user\_id) ); CREATE TABLE job\_post\_reminders ( reminder\_id INT PRIMARY KEY, job\_id INT, user\_id INT, title VARCHAR(255), description TEXT, reminder\_text TEXT, reminder\_date DATE, remind\_at TIMESTAMP, is\_completed BOOLEAN NOT NULL DEFAULT FALSE, completed BOOLEAN NOT NULL DEFAULT FALSE, FOREIGN KEY (job\_id) REFERENCES job\_posts(job\_id), FOREIGN KEY (user\_id) REFERENCES users(user\_id) ); CREATE TABLE job\_post\_skills (job\_post\_skill\_id INT PRIMARY KEY, job\_id INT, skill\_id INT, required BOOLEAN NOT NULL,, FOREIGN KEY (job\_id) REFERENCES job\_posts(job\_id),, FOREIGN KEY (skill\_id) REFERENCES skill\_definitions(skill\_id)); CREATE TABLE job\_post\_statuses ( status\_id INT PRIMARY KEY, status\_name VARCHAR(255) NOT NULL UNIQUE ); CREATE TABLE job\_post\_tag\_assignments ( assignment\_id INT PRIMARY KEY, job\_id INT, tag\_id INT,, FOREIGN KEY (job\_id) REFERENCES job\_posts(job\_id),, FOREIGN KEY (tag\_id) REFERENCES job\_post\_tags(tag\_id) ); CREATE TABLE job\_post\_tags ( association\_id INT PRIMARY KEY, job\_id INT, tag\_id INT,, FOREIGN KEY (job\_id) REFERENCES job\_posts(job\_id),, FOREIGN KEY (tag\_id) REFERENCES job\_post\_tags(tag\_id) ); CREATE TABLE job\_post\_tags ( tag\_id INT PRIMARY KEY, tag\_name VARCHAR(255) NOT NULL UNIQUE ); CREATE TABLE job\_post\_views ( view\_stat\_id INT PRIMARY KEY, job\_id INT, user\_id INT, view\_date TIMESTAMP NOT NULL,, FOREIGN KEY (job\_id) REFERENCES job\_posts(job\_id),, FOREIGN KEY (user\_id) REFERENCES users(user\_id) ); CREATE TABLE job\_posts ( job\_id INT PRIMARY KEY, company\_id INT, position\_id INT, status\_id INT, job\_description TEXT NOT NULL, min\_experience\_years INT, max\_experience\_years INT, salary\_min DECIMAL(10,2), salary\_max DECIMAL(10,2), CREATEd\_at TIMESTAMP NOT NULL, updated\_at TIMESTAMP,, FOREIGN KEY (company\_id) REFERENCES companies(company\_id),, FOREIGN KEY (position\_id) REFERENCES job\_positions(position\_id),, FOREIGN KEY (status\_id) REFERENCES job\_post\_statuses(status\_id) );
> 
> 1 / 1

Here are the refactored table definitions with primary keys named 'id', table-level comments, and column-level comments:

sql

```sql
-- Job Application Statuses
CREATE TABLE job_application_statuses (
    id INT PRIMARY KEY,                        -- Primary key
    status_name TEXT NOT NULL UNIQUE           -- Status name, unique
);

-- Job Applications
CREATE TABLE job_applications (
    id INT PRIMARY KEY,                        -- Primary key
    job_id INT,                                -- Foreign key referencing job_posts
    user_id INT,                               -- Foreign key referencing users
    application_status_id INT,                 -- Foreign key referencing application_statuses
    resume_url TEXT NOT NULL,                  -- Resume URL, not null
    cover_letter_url TEXT,                     -- Cover letter URL
    application_status TEXT NOT NULL,          -- Application status, not null
    applied_at TIMESTAMP NOT NULL,             -- Applied timestamp, not null
    FOREIGN KEY (job_id) REFERENCES job_posts(id),
    FOREIGN KEY (user_id) REFERENCES users(id),
    FOREIGN KEY (application_status_id) REFERENCES job_application_statuses(id)
);

-- Job Offer Statuses
CREATE TABLE job_offer_statuses (
    id INT PRIMARY KEY,                        -- Primary key
    status_name TEXT NOT NULL UNIQUE           -- Status name, unique
);

-- Job Offers
CREATE TABLE job_offers (
    id INT PRIMARY KEY,                        -- Primary key
    application_id INT,                        -- Foreign key referencing job_applications
    offer_status_id INT,                       -- Foreign key referencing job_offer_statuses
    salary DECIMAL(10,2) NOT NULL,             -- Salary, not null
    start_date DATE NOT NULL,                  -- Start date, not null
    offer_date DATE NOT NULL
```

1 / 1

> please continue directly where you have left off with code. No need for an introduction
> 
> 1 / 1

sql

    ```sql
accepted_date DATE,                        -- Accepted date
    declined_date DATE,                        -- Declined date
    FOREIGN KEY (application_id) REFERENCES job_applications(id),
    FOREIGN KEY (offer_status_id) REFERENCES job_offer_statuses(id)
);

-- Job Positions
CREATE TABLE job_positions (
    id INT PRIMARY KEY,                        -- Primary key
    position_title TEXT NOT NULL UNIQUE        -- Position title, unique
);

-- Job Post Access Logs
CREATE TABLE job_post_access_logs (
    id INT PRIMARY KEY,                        -- Primary key
    job_id INT,                                -- Foreign key referencing job_posts
    user_id INT,                               -- Foreign key referencing users
    action TEXT NOT NULL,                      -- Action, not null
    ip_address TEXT,                           -- IP address
    user_agent TEXT,                           -- User agent
    accessed_at TIMESTAMP NOT NULL,            -- Accessed timestamp, not null
    FOREIGN KEY (job_id) REFERENCES job_posts(id),
    FOREIGN KEY (user_id) REFERENCES users(id)
);

-- Job Post Activity Logs
CREATE TABLE job_post_activity_logs (
    id INT PRIMARY KEY,                        -- Primary key
    job_id INT,                                -- Foreign key referencing job_posts
    user_id INT,                               -- Foreign key referencing users
    activity TEXT NOT NULL,                    -- Activity, not null
    description TEXT,                          -- Description
    activity_timestamp TIMESTAMP NOT NULL,     -- Activity timestamp, not null
```

1 / 1

> please continue directly where you have left off with code. No need for an introduction
> 
> 3 / 3

sql

    ```sql
FOREIGN KEY (job_id) REFERENCES job_posts(id),
    FOREIGN KEY (user_id) REFERENCES users(id)
);

-- Job Post Attachments
CREATE TABLE job_post_attachments (
    id INT PRIMARY KEY,                        -- Primary key
    job_id INT,                                -- Foreign key referencing job_posts
    file_name TEXT NOT NULL,                   -- File name, not null
    file_path TEXT NOT NULL,                   -- File path, not null
    file_type TEXT NOT NULL,                   -- File type, not null
    file_size INT NOT NULL,                    -- File size, not null
    uploaded_at TIMESTAMP NOT NULL,            -- Uploaded timestamp, not null
    FOREIGN KEY (job_id) REFERENCES job_posts(id)
);

-- Job Post Communications
CREATE TABLE job_post_communications (
    id INT PRIMARY KEY,                        -- Primary key
    job_id INT,                                -- Foreign key referencing job_posts
    author_id INT,                             -- Foreign key referencing users
    communication_type TEXT NOT NULL,          -- Communication type, not null
    content TEXT NOT NULL,                     -- Content, not null
    created
```

1 / 1

> please continue directly where you have left off with code. No need for an introduction
> 
> 1 / 1

sql

    ```sql
created_at TIMESTAMP NOT NULL,             -- Created timestamp, not null
    FOREIGN KEY (job_id) REFERENCES job_posts(id),
    FOREIGN KEY (author_id) REFERENCES users(id)
);

-- Job Post Custom Field Definitions
CREATE TABLE job_post_custom_field_definitions (
    id INT PRIMARY KEY,                        -- Primary key
    job_id INT,                                -- Foreign key referencing job_posts
    custom_field_id INT,                       -- Foreign key referencing custom_field_definitions
    value TEXT NOT NULL,                       -- Value, not null
    FOREIGN KEY (job_id) REFERENCES job_posts(id),
    FOREIGN KEY (custom_field_id) REFERENCES custom_field_definitions(id)
);

-- Job Post Custom Field Values
CREATE TABLE job_post_custom_field_values (
    id INT PRIMARY KEY,                        -- Primary key
    job_id INT,                                -- Foreign key referencing job_posts
    custom_field_id INT,                       -- Foreign key referencing custom_field_definitions
    value TEXT,                                -- Value
    FOREIGN KEY (job_id) REFERENCES job_posts(id),
    FOREIGN KEY (custom_field_id) REFERENCES custom_field_definitions(id)
);

-- Job Post Event Logs
CREATE TABLE job_post_event_logs (
    id INT PRIMARY KEY,                        -- Primary key
    job_id INT,                                -- Foreign key referencing job_posts
    user_id INT,                               -- Foreign key referencing users
    event_type TEXT NOT NULL,
```

1 / 1

> please continue directly where you have left off with code. No need for an introduction
> 
> 1 / 1

sql

    ```sql
event_description TEXT,                    -- Event description
    event_timestamp TIMESTAMP NOT NULL,        -- Event timestamp, not null
    FOREIGN KEY (job_id) REFERENCES job_posts(id),
    FOREIGN KEY (user_id) REFERENCES users(id)
);

-- Job Post Reminders
CREATE TABLE job_post_reminders (
    id INT PRIMARY KEY,                        -- Primary key
    job_id INT,                                -- Foreign key referencing job_posts
    user_id INT,                               -- Foreign key referencing users
    title VARCHAR(255),                        -- Title
    description TEXT,                          -- Description
    reminder_text TEXT,                        -- Reminder text
    reminder_date DATE,                        -- Reminder date
    remind_at TIMESTAMP,                       -- Remind at timestamp
    is_completed BOOLEAN NOT NULL DEFAULT FALSE, -- Is completed flag, not null, default false
    completed BOOLEAN NOT NULL DEFAULT FALSE, -- Completed flag, not null, default false
    FOREIGN KEY (job_id) REFERENCES job_posts(id),
    FOREIGN KEY (user_id) REFERENCES users(id)
);

-- Job Post Skills
CREATE TABLE job_post_skills (
    id INT PRIMARY KEY,                        -- Primary key
    job_id INT,                                -- Foreign key referencing job_posts
    skill_id INT,                              -- Foreign key referencing skill_definitions
    required BOOLEAN NOT NULL,                 -- Required flag, not null
    FOREIGN KEY (job_id) REFERENCES job_posts(id
```

1 / 1

> please continue directly where you have left off with code. No need for an introduction
> 
> 1 / 1

sql

    ```sql
FOREIGN KEY (skill_id) REFERENCES skill_definitions(id)
);

-- Job Post Statuses
CREATE TABLE job_post_statuses (
    id INT PRIMARY KEY,                        -- Primary key
    status_name VARCHAR(255) NOT NULL UNIQUE   -- Status name, not null, unique
);

-- Job Post Tag Assignments
CREATE TABLE job_post_tag_assignments (
    id INT PRIMARY KEY,                        -- Primary key
    job_id INT,                                -- Foreign key referencing job_posts
    tag_id INT,                                -- Foreign key referencing job_post_tags
    FOREIGN KEY (job_id) REFERENCES job_posts(id),
    FOREIGN KEY (tag_id) REFERENCES job_post_tags(id)
);

-- Job Post Tags
CREATE TABLE job_post_tags (
    id INT PRIMARY KEY,                        -- Primary key
    tag_name VARCHAR(255) NOT NULL UNIQUE      -- Tag name, not null, unique
);

-- Job Post Views
CREATE TABLE job_post_views (
    id INT PRIMARY KEY,                        -- Primary key
    job_id INT,                                -- Foreign key referencing job_posts
    user_id INT,                               -- Foreign key referencing users
    view_date TIMESTAMP NOT NULL,              -- View date, not null
    FOREIGN KEY (job_id) REFERENCES job_posts(id),
    FOREIGN KEY (user_id) REFERENCES users(id)
);

-- Job Posts
CREATE TABLE job_posts (
    id INT
```

1 / 1

> please continue directly where you have left off with code. No need for an introduction
> 
> 1 / 1

sql

    ```sql
id INT PRIMARY KEY,                        -- Primary key
    company_id INT,                            -- Foreign key referencing companies
    position_id INT,                           -- Foreign key referencing job_positions
    status_id INT,                             -- Foreign key referencing job_post_statuses
    job_description TEXT NOT NULL,             -- Job description, not null
    min_experience_years INT,                  -- Minimum experience in years
    max_experience_years INT,                  -- Maximum experience in years
    salary_min DECIMAL(10,2),                  -- Minimum salary
    salary_max DECIMAL(10,2),                  -- Maximum salary
    created_at TIMESTAMP NOT NULL,             -- Timestamp when the job post was created
    updated_at TIMESTAMP,                      -- Timestamp when the job post was last updated
    FOREIGN KEY (company_id) REFERENCES companies(id),
    FOREIGN KEY (position_id) REFERENCES job_positions(id),
    FOREIGN KEY (status_id) REFERENCES job_post_statuses(id)
);
```

These table definitions have been refactored with the requested improvements. The primary key columns are now named 'id', and the table and column comments have been added.

1 / 1

> The ddl you have output for job\_post\_custom\_field\_definitions and job\_post\_custom\_field\_values have foreign keys to a table called custom\_field\_definitions - can you output this table ddl. Also job\_post\_skills references skills\_definitions
> 
> 4 / 4

My apologies for the confusion. Based on the mentioned relationships, I'll provide the DDL for the `custom_field_definitions`, `skill_definitions` tables, and adjust the `job_post_custom_field_definitions` and `job_post_skills` tables accordingly.

sql

```sql
-- Custom Field Definitions
CREATE TABLE custom_field_definitions (
    id INT PRIMARY KEY,                       -- Primary key
    field_name VARCHAR(255) NOT NULL UNIQUE,  -- Unique custom field name
    field_description TEXT                    -- Custom field description
);

-- Skill Definitions
CREATE TABLE skill_definitions (
    id INT PRIMARY KEY,                       -- Primary key
    skill_name VARCHAR(255) NOT NULL UNIQUE   -- Unique skill name
);

-- Job Post Custom Field Definitions
CREATE TABLE job_post_custom_field_definitions (
    id INT PRIMARY KEY,                          -- Primary key
    job_id INT,                                  -- Foreign key referencing job_posts
    custom_field_id INT,                         -- Foreign key referencing custom_field_definitions
    value TEXT NOT NULL,                         -- Custom field value, not null
    FOREIGN KEY (job_id) REFERENCES job_posts(id),
    FOREIGN KEY (custom_field_id) REFERENCES custom_field_definitions(id)
);

-- Job Post Skills
CREATE TABLE job_post_skills (
    id INT PRIMARY KEY,                        -- Primary key
    job_id INT,                                -- Foreign key referencing job_posts
    skill_id INT,                              -- Foreign key referencing skill_definitions
    required BOOLEAN NOT NULL,                 -- Whether the skill is required or not
    FOREIGN KEY (job_id) REFERENCES job_posts(id),
    FOREIGN KEY (skill_id) REFERENCES skill_definitions
```

1 / 1

> please continue directly where you have left off with code. No need for an introduction
> 
> 1 / 1

(id) );

javascript

```javascript
The tables have been adjusted as requested. The `custom_field_definitions` and `skill_definitions` tables have been added, and the foreign key relationships in the `job_post_custom_field_definitions` and `job_post_skills` tables have been updated accordingly.
```

1 / 1